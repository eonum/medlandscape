{"ast":null,"code":"import _classCallCheck from \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/src/components/InteractiveTable/ResultTable/ResultTable.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Table from '../../Table/Table.js';\nimport './ResultTable.css';\nimport { withTranslation } from 'react-i18next';\n/**\n * Represents the part of the table which displays the results\n */\n\nvar ResultTable =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ResultTable, _Component);\n\n  function ResultTable(props) {\n    var _this;\n\n    _classCallCheck(this, ResultTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ResultTable).call(this, props));\n\n    _this.canTableBeGenerated = function () {\n      var shouldGenerate = true; // check if in each hospital dropdown something was selected\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = _this.props.selectedHospitals[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var hosp = _step.value;\n\n          if (Object.keys(hosp).length === 0 && hosp.constructor === Object) {\n            shouldGenerate = false;\n            break;\n          }\n        } // check the same for variables\n\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      if (shouldGenerate) {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n          for (var _iterator2 = _this.props.selectedVariables[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n            var variable = _step2.value;\n\n            if (Object.keys(variable).length === 0 && variable.constructor === Object) {\n              shouldGenerate = false;\n              break;\n            } // also check if for the selected variables the data was fetched\n\n\n            if (!_this.props.hospitalData[0].attributes[variable.name]) {\n              shouldGenerate = false;\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError2 = true;\n          _iteratorError2 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n              _iterator2.return();\n            }\n          } finally {\n            if (_didIteratorError2) {\n              throw _iteratorError2;\n            }\n          }\n        }\n      }\n\n      if (!shouldGenerate) {\n        window.alert(_this.props.t('tableView.missingData'));\n      }\n\n      return shouldGenerate;\n    };\n\n    _this.state = {\n      resultTableData: []\n    };\n    return _this;\n  }\n  /**\n   * canTableBeGenerated - checks if in each dropdown something is selected,\n   *  and if the data has been fetched for these selected things.\n   *\n   * @return {bool} true, if everything is selected and the data is loaded,\n   *  false otherwise\n   */\n\n\n  _createClass(ResultTable, [{\n    key: \"componentDidUpdate\",\n\n    /**\n     * componentDidUpdate - generates a 2D-array from selectedVariables and\n     *  selectedHospitals and sets the state.\n     *\n     * @return {type}  description\n     */\n    value: function componentDidUpdate() {\n      var tableData = [];\n\n      if (this.props.dataLoaded) {\n        if (this.canTableBeGenerated()) {\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = this.props.selectedHospitals[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var hosp = _step3.value;\n              var newRow = [];\n              var currentHosp = void 0;\n              var _iteratorNormalCompletion4 = true;\n              var _didIteratorError4 = false;\n              var _iteratorError4 = undefined;\n\n              try {\n                for (var _iterator4 = this.props.hospitalData[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                  var hosp2 = _step4.value;\n\n                  if (hosp.name === hosp2.name) {\n                    currentHosp = hosp2;\n                    break;\n                  }\n                }\n              } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n                    _iterator4.return();\n                  }\n                } finally {\n                  if (_didIteratorError4) {\n                    throw _iteratorError4;\n                  }\n                }\n              }\n\n              var _iteratorNormalCompletion5 = true;\n              var _didIteratorError5 = false;\n              var _iteratorError5 = undefined;\n\n              try {\n                for (var _iterator5 = this.props.selectedVariables[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n                  var variable = _step5.value;\n\n                  if (variable.is_time_series) {\n                    var latestYear = Object.keys(currentHosp.attributes[variable.name]).sort()[Object.keys(currentHosp.attributes[variable.name]).length - 1];\n                    var obj = currentHosp.attributes[variable.name];\n                    newRow.push(obj[latestYear]);\n                  } else {\n                    newRow.push(currentHosp.attributes[variable.name]);\n                  }\n                }\n              } catch (err) {\n                _didIteratorError5 = true;\n                _iteratorError5 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n                    _iterator5.return();\n                  }\n                } finally {\n                  if (_didIteratorError5) {\n                    throw _iteratorError5;\n                  }\n                }\n              }\n\n              tableData.push(newRow);\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n\n          this.setState({\n            resultTableData: tableData\n          });\n          this.props.submitTableData(tableData);\n        }\n\n        this.props.dataGenerated();\n      }\n    }\n    /**\n     * render - renders the component to the screen\n     *\n     * @return {JSX}  JSX of the component\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, React.createElement(Table, {\n        tableData: this.state.resultTableData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return ResultTable;\n}(Component);\n/**\n* PropTypes\n*\n* selectedHospitals: array containing all selected hospitals\n* selectedVariables: array containing all selected variables\n* hospitals: array containing all hospitals and values of the selected variables\n* submitTableData: function that is called to give the generated 2D-array to\n*   the parent component\n*/\n\n\nResultTable.propTypes = {\n  selectedHospitals: PropTypes.array.isRequired,\n  selectedVariables: PropTypes.array.isRequired,\n  hospitalData: PropTypes.array.isRequired,\n  submitTableData: PropTypes.func.isRequired\n};\nvar LocalizedResultTable = withTranslation()(ResultTable);\nexport default LocalizedResultTable;","map":{"version":3,"sources":["/Users/moriarty/Documents/UniBe/PSE/medlandscape/medlandscape-app/src/components/InteractiveTable/ResultTable/ResultTable.js"],"names":["React","Component","PropTypes","Table","withTranslation","ResultTable","props","canTableBeGenerated","shouldGenerate","selectedHospitals","hosp","Object","keys","length","constructor","selectedVariables","variable","hospitalData","attributes","name","window","alert","t","state","resultTableData","tableData","dataLoaded","newRow","currentHosp","hosp2","is_time_series","latestYear","sort","obj","push","setState","submitTableData","dataGenerated","propTypes","array","isRequired","func","LocalizedResultTable"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Table from '../../Table/Table.js'\nimport './ResultTable.css';\nimport { withTranslation } from 'react-i18next';\n\n/**\n * Represents the part of the table which displays the results\n */\nclass ResultTable extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            resultTableData: []\n        }\n    }\n\n    /**\n     * canTableBeGenerated - checks if in each dropdown something is selected,\n     *  and if the data has been fetched for these selected things.\n     *\n     * @return {bool} true, if everything is selected and the data is loaded,\n     *  false otherwise\n     */\n    canTableBeGenerated = () => {\n        let shouldGenerate = true;\n\n        // check if in each hospital dropdown something was selected\n        for (let hosp of this.props.selectedHospitals) {\n            if (Object.keys(hosp).length === 0 && hosp.constructor === Object) {\n                shouldGenerate = false;\n                break;\n            }\n        }\n        // check the same for variables\n        if (shouldGenerate) {\n            for (let variable of this.props.selectedVariables) {\n                if (Object.keys(variable).length === 0 && variable.constructor === Object) {\n                    shouldGenerate = false;\n                    break;\n                }\n                // also check if for the selected variables the data was fetched\n                if (!this.props.hospitalData[0].attributes[variable.name]) {\n                    shouldGenerate = false;\n                    break;\n                }\n            }\n        }\n        if (!shouldGenerate) {\n            window.alert(this.props.t('tableView.missingData'));\n        }\n        return shouldGenerate;\n    }\n\n    /**\n     * componentDidUpdate - generates a 2D-array from selectedVariables and\n     *  selectedHospitals and sets the state.\n     *\n     * @return {type}  description\n     */\n    componentDidUpdate() {\n        let tableData = [];\n\n        if (this.props.dataLoaded) {\n            if (this.canTableBeGenerated()) {\n                for (let hosp of this.props.selectedHospitals) {\n                    let newRow = [];\n                    let currentHosp;\n                    for (let hosp2 of this.props.hospitalData) {\n                        if (hosp.name === hosp2.name) {\n                            currentHosp = hosp2;\n                            break;\n                        }\n                    }\n                    for (let variable of this.props.selectedVariables) {\n                        if (variable.is_time_series) {\n                            const latestYear = Object.keys(currentHosp.attributes[variable.name])\n                                .sort()[Object.keys(currentHosp.attributes[variable.name]).length -1];\n                            const obj = currentHosp.attributes[variable.name];\n                            newRow.push(obj[latestYear]);\n                        } else {\n                            newRow.push(currentHosp.attributes[variable.name]);\n                        }\n                    }\n                    tableData.push(newRow);\n                }\n                this.setState({\n                    resultTableData: tableData\n                })\n                this.props.submitTableData(tableData);\n            }\n            this.props.dataGenerated()\n        }\n    }\n    /**\n     * render - renders the component to the screen\n     *\n     * @return {JSX}  JSX of the component\n     */\n    render() {\n        return (\n            <div>\n                <Table tableData={this.state.resultTableData} />\n            </div>\n        );\n    }\n}\n\n/**\n* PropTypes\n*\n* selectedHospitals: array containing all selected hospitals\n* selectedVariables: array containing all selected variables\n* hospitals: array containing all hospitals and values of the selected variables\n* submitTableData: function that is called to give the generated 2D-array to\n*   the parent component\n*/\nResultTable.propTypes = {\n    selectedHospitals: PropTypes.array.isRequired,\n    selectedVariables: PropTypes.array.isRequired,\n    hospitalData: PropTypes.array.isRequired,\n    submitTableData: PropTypes.func.isRequired,\n}\n\nconst LocalizedResultTable = withTranslation()(ResultTable);\nexport default LocalizedResultTable;\n"]},"metadata":{},"sourceType":"module"}